.. _examples:

Generating QR codes
-------------------

PyBankID cannot generate QR codes for you, but there is an example application in the
`examples folder of the repo <https://github.com/hbldh/pybankid/tree/master/examples>`_ where a
Flask application called ``qrdemo`` shows one way to do authentication with animated QR codes.

The content for the QR code is generated by this method:

.. code-block:: python

    import hashlib
    import hmac
    from math import floor
    import time

    def generate_qr_code_content(qr_start_token: str, start_t: float, qr_start_secret: str):
    """Given QR start token, time.time() when initiated authentication call was made and the
    QR start secret, calculate the current QR code content to display.
    """
        elapsed_seconds_since_call = int(floor(time.time() - start_t))
        qr_auth_code = hmac.new(
            qr_start_secret.encode(),
            msg=str(elapsed_seconds_since_call).encode(),
            digestmod=hashlib.sha256,
        ).hexdigest()
        return f"bankid.{qr_start_token}.{elapsed_seconds_since_call}.{qr_auth_code}"

